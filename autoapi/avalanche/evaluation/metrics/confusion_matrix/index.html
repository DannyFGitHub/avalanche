

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>avalanche.evaluation.metrics.confusion_matrix &mdash; Avalanche 0.1 documentation</title>
  

  
  <link rel="stylesheet" href="../../../../../_static/css/mystyle.css" type="text/css" />
  <link rel="stylesheet" href="../../../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../../../_static/css/mystyle.css" type="text/css" />
  <link rel="stylesheet" href="../../../../../_static/graphviz.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../../../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../../../" src="../../../../../_static/documentation_options.js"></script>
        <script data-url_root="../../../../../" id="documentation_options" src="../../../../../_static/documentation_options.js"></script>
        <script src="../../../../../_static/jquery.js"></script>
        <script src="../../../../../_static/underscore.js"></script>
        <script src="../../../../../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../../../../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../../../../genindex/" />
    <link rel="search" title="Search" href="../../../../../search/" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../../../">
          

          
            
            <img src="../../../../../_static/avalanche_logo.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../../search/" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption" role="heading"><span class="caption-text">Avalanche API:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../../../../">API Reference</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../../../"><code class="xref py py-mod docutils literal notranslate"><span class="pre">avalanche</span></code></a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="../../../#subpackages">Subpackages</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="../../../benchmarks/"><code class="xref py py-mod docutils literal notranslate"><span class="pre">avalanche.benchmarks</span></code></a></li>
<li class="toctree-l4 current"><a class="reference internal" href="../../"><code class="xref py py-mod docutils literal notranslate"><span class="pre">avalanche.evaluation</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../logging/"><code class="xref py py-mod docutils literal notranslate"><span class="pre">avalanche.logging</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../models/"><code class="xref py py-mod docutils literal notranslate"><span class="pre">avalanche.models</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../training/"><code class="xref py py-mod docutils literal notranslate"><span class="pre">avalanche.training</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../#submodules">Submodules</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../core/"><code class="xref py py-mod docutils literal notranslate"><span class="pre">avalanche.core</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../#package-contents">Package Contents</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../#avalanche.__version__">__version__</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../../">Avalanche</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../../../" class="icon icon-home"></a> &raquo;</li>
        
      <li><code class="xref py py-mod docutils literal notranslate"><span class="pre">avalanche.evaluation.metrics.confusion_matrix</span></code></li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../../../../../_sources/autoapi/avalanche/evaluation/metrics/confusion_matrix/index.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="module-avalanche.evaluation.metrics.confusion_matrix">
<span id="avalanche-evaluation-metrics-confusion-matrix"></span><h1><a class="reference internal" href="#module-avalanche.evaluation.metrics.confusion_matrix" title="avalanche.evaluation.metrics.confusion_matrix"><code class="xref py py-mod docutils literal notranslate"><span class="pre">avalanche.evaluation.metrics.confusion_matrix</span></code></a><a class="headerlink" href="#module-avalanche.evaluation.metrics.confusion_matrix" title="Permalink to this headline">¶</a></h1>
<div class="section" id="module-contents">
<h2>Module Contents<a class="headerlink" href="#module-contents" title="Permalink to this headline">¶</a></h2>
<div class="section" id="classes">
<h3>Classes<a class="headerlink" href="#classes" title="Permalink to this headline">¶</a></h3>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#avalanche.evaluation.metrics.confusion_matrix.ConfusionMatrix" title="avalanche.evaluation.metrics.confusion_matrix.ConfusionMatrix"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ConfusionMatrix</span></code></a></p></td>
<td><p>The standalone confusion matrix metric.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#avalanche.evaluation.metrics.confusion_matrix.StreamConfusionMatrix" title="avalanche.evaluation.metrics.confusion_matrix.StreamConfusionMatrix"><code class="xref py py-obj docutils literal notranslate"><span class="pre">StreamConfusionMatrix</span></code></a></p></td>
<td><p>The Stream Confusion Matrix metric.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#avalanche.evaluation.metrics.confusion_matrix.WandBStreamConfusionMatrix" title="avalanche.evaluation.metrics.confusion_matrix.WandBStreamConfusionMatrix"><code class="xref py py-obj docutils literal notranslate"><span class="pre">WandBStreamConfusionMatrix</span></code></a></p></td>
<td><p>Confusion Matrix metric compatible with Weights and Biases logger.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="functions">
<h3>Functions<a class="headerlink" href="#functions" title="Permalink to this headline">¶</a></h3>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#avalanche.evaluation.metrics.confusion_matrix.confusion_matrix_metrics" title="avalanche.evaluation.metrics.confusion_matrix.confusion_matrix_metrics"><code class="xref py py-obj docutils literal notranslate"><span class="pre">confusion_matrix_metrics</span></code></a>(num_classes=None, normalize=None, save_image=True, image_creator=default_cm_image_creator, class_names=None, stream=False, wandb=False, absolute_class_order: bool = False) → List[PluginMetric]</p></td>
<td><p>Helper method that can be used to obtain the desired set of</p></td>
</tr>
</tbody>
</table>
<dl class="py class">
<dt class="sig sig-object py" id="avalanche.evaluation.metrics.confusion_matrix.ConfusionMatrix">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">avalanche.evaluation.metrics.confusion_matrix.</span></span><span class="sig-name descname"><span class="pre">ConfusionMatrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_classes</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="pre">'true'</span><span class="p"><span class="pre">,</span> </span><span class="pre">'pred'</span><span class="p"><span class="pre">,</span> </span><span class="pre">'all'</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../../_modules/avalanche/evaluation/metrics/confusion_matrix/#ConfusionMatrix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#avalanche.evaluation.metrics.confusion_matrix.ConfusionMatrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Metric[Tensor]</span></code></p>
<p>The standalone confusion matrix metric.</p>
<p>Instances of this metric keep track of the confusion matrix by receiving a
pair of “ground truth” and “prediction” Tensors describing the labels of a
minibatch. Those two tensors can both contain plain labels or
one-hot/logit vectors.</p>
<p>The result is the unnormalized running confusion matrix.</p>
<p>Beware that by default the confusion matrix size will depend on the value of
the maximum label as detected by looking at both the ground truth and
predictions Tensors. When passing one-hot/logit vectors, this
metric will try to infer the number of classes from the vector sizes.
Otherwise, the maximum label value encountered in the truth/prediction
Tensors will be used.</p>
<p>If the user sets the <cite>num_classes</cite>, then the confusion matrix will always be
of size <cite>num_classes, num_classes</cite>. Whenever a prediction or label tensor is
provided as logits, only the first <cite>num_classes</cite> units will be considered in
the confusion matrix computation. If they are provided as numerical labels,
each of them has to be smaller than <cite>num_classes</cite>.</p>
<p>The reset method will bring the metric to its initial state. By default
this metric in its initial state will return an empty Tensor.</p>
<p>Creates an instance of the standalone confusion matrix metric.</p>
<p>By default this metric in its initial state will return an empty Tensor.
The metric can be updated by using the <cite>update</cite> method while the running
confusion matrix can be retrieved using the <cite>result</cite> method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>num_classes</strong> – The number of classes. Defaults to None,
which means that the number of classes will be inferred from
ground truth and prediction Tensors (see class description for more
details). If not None, the confusion matrix will always be of size
<cite>num_classes, num_classes</cite> and only the first <cite>num_classes</cite> values
of output logits or target logits will be considered in the update.
If the output or targets are provided as numerical labels,
there can be no label greater than <cite>num_classes</cite>.</p></li>
<li><p><strong>normalize</strong> – how to normalize confusion matrix.
None to not normalize</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="avalanche.evaluation.metrics.confusion_matrix.ConfusionMatrix.update">
<span class="sig-name descname"><span class="pre">update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">true_y</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">predicted_y</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../../../../../_modules/avalanche/evaluation/metrics/confusion_matrix/#ConfusionMatrix.update"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#avalanche.evaluation.metrics.confusion_matrix.ConfusionMatrix.update" title="Permalink to this definition">¶</a></dt>
<dd><p>Update the running confusion matrix given the true and predicted labels.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>true_y</strong> – The ground truth. Both labels and one-hot vectors
are supported.</p></li>
<li><p><strong>predicted_y</strong> – The ground truth. Both labels and logit vectors
are supported.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="avalanche.evaluation.metrics.confusion_matrix.ConfusionMatrix.result">
<span class="sig-name descname"><span class="pre">result</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="../../../../../_modules/avalanche/evaluation/metrics/confusion_matrix/#ConfusionMatrix.result"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#avalanche.evaluation.metrics.confusion_matrix.ConfusionMatrix.result" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrieves the unnormalized confusion matrix.</p>
<p>Calling this method will not change the internal state of the metric.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The running confusion matrix, as a Tensor.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="avalanche.evaluation.metrics.confusion_matrix.ConfusionMatrix.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../../../../../_modules/avalanche/evaluation/metrics/confusion_matrix/#ConfusionMatrix.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#avalanche.evaluation.metrics.confusion_matrix.ConfusionMatrix.reset" title="Permalink to this definition">¶</a></dt>
<dd><p>Resets the metric.</p>
<p>Calling this method will <em>not</em> reset the default number of classes
optionally defined in the constructor optional parameter.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="avalanche.evaluation.metrics.confusion_matrix.ConfusionMatrix.nan_to_num">
<em class="property"><span class="pre">static</span> </em><span class="sig-name descname"><span class="pre">nan_to_num</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">matrix</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="../../../../../_modules/avalanche/evaluation/metrics/confusion_matrix/#ConfusionMatrix.nan_to_num"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#avalanche.evaluation.metrics.confusion_matrix.ConfusionMatrix.nan_to_num" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="avalanche.evaluation.metrics.confusion_matrix.StreamConfusionMatrix">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">avalanche.evaluation.metrics.confusion_matrix.</span></span><span class="sig-name descname"><span class="pre">StreamConfusionMatrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_classes</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span> </span><span class="pre">Mapping</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="pre">'true'</span><span class="p"><span class="pre">,</span> </span><span class="pre">'pred'</span><span class="p"><span class="pre">,</span> </span><span class="pre">'all'</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_image</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">image_creator</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">,</span> </span><span class="pre">Sequence</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span> </span><span class="pre">Image</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">default_cm_image_creator</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">absolute_class_order</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../../_modules/avalanche/evaluation/metrics/confusion_matrix/#StreamConfusionMatrix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#avalanche.evaluation.metrics.confusion_matrix.StreamConfusionMatrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">PluginMetric[Tensor]</span></code></p>
<p>The Stream Confusion Matrix metric.
This plugin metric only works on the eval phase.</p>
<p>Confusion Matrix computation can be slow if you compute it for a large
number of classes. We recommend to set <cite>save_image=False</cite> if the runtime
is too large.</p>
<p>At the end of the eval phase, this metric logs the confusion matrix
relative to all the patterns seen during eval.</p>
<p>The metric can log either a Tensor or a PIL Image representing the
confusion matrix.</p>
<p>Creates an instance of the Stream Confusion Matrix metric.</p>
<p>We recommend to set <cite>save_image=False</cite> if the runtime is too large.
In fact, a large number of classes may increase the computation time
of this metric.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>num_classes</strong> – The number of classes. Defaults to None,
which means that the number of classes will be inferred from
ground truth and prediction Tensors (see class description for more
details). If not None, the confusion matrix will always be of size
<cite>num_classes, num_classes</cite> and only the first <cite>num_classes</cite> values
of output logits or target logits will be considered in the update.
If the output or targets are provided as numerical labels,
there can be no label greater than <cite>num_classes</cite>.</p></li>
<li><p><strong>normalize</strong> – Normalizes confusion matrix over the true (rows),
predicted (columns) conditions or all the population. If None,
confusion matrix will not be normalized. Valid values are: ‘true’,
‘pred’ and ‘all’ or None.</p></li>
<li><p><strong>save_image</strong> – If True, a graphical representation of the confusion
matrix will be logged, too. If False, only the Tensor representation
will be logged. Defaults to True.</p></li>
<li><p><strong>image_creator</strong> – A callable that, given the tensor representation
of the confusion matrix and the corresponding labels, returns a
graphical representation of the matrix as a PIL Image. Defaults to
<cite>default_cm_image_creator</cite>.</p></li>
<li><p><strong>absolute_class_order</strong> – If true, the labels in the created image
will be sorted by id, otherwise they will be sorted by order of
encounter at training time. This parameter is ignored if
<cite>save_image</cite> is False, or the scenario is not a NCScenario.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="avalanche.evaluation.metrics.confusion_matrix.StreamConfusionMatrix.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../../../../../_modules/avalanche/evaluation/metrics/confusion_matrix/#StreamConfusionMatrix.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#avalanche.evaluation.metrics.confusion_matrix.StreamConfusionMatrix.reset" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="avalanche.evaluation.metrics.confusion_matrix.StreamConfusionMatrix.result">
<span class="sig-name descname"><span class="pre">result</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="../../../../../_modules/avalanche/evaluation/metrics/confusion_matrix/#StreamConfusionMatrix.result"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#avalanche.evaluation.metrics.confusion_matrix.StreamConfusionMatrix.result" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="avalanche.evaluation.metrics.confusion_matrix.StreamConfusionMatrix.update">
<span class="sig-name descname"><span class="pre">update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">true_y</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">predicted_y</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../../../../../_modules/avalanche/evaluation/metrics/confusion_matrix/#StreamConfusionMatrix.update"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#avalanche.evaluation.metrics.confusion_matrix.StreamConfusionMatrix.update" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="avalanche.evaluation.metrics.confusion_matrix.StreamConfusionMatrix.before_eval">
<span class="sig-name descname"><span class="pre">before_eval</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">strategy</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../../../../../_modules/avalanche/evaluation/metrics/confusion_matrix/#StreamConfusionMatrix.before_eval"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#avalanche.evaluation.metrics.confusion_matrix.StreamConfusionMatrix.before_eval" title="Permalink to this definition">¶</a></dt>
<dd><p>Called before <cite>eval</cite> by the <cite>BaseStrategy</cite>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="avalanche.evaluation.metrics.confusion_matrix.StreamConfusionMatrix.after_eval_iteration">
<span class="sig-name descname"><span class="pre">after_eval_iteration</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">strategy</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">BaseStrategy</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../../../../../_modules/avalanche/evaluation/metrics/confusion_matrix/#StreamConfusionMatrix.after_eval_iteration"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#avalanche.evaluation.metrics.confusion_matrix.StreamConfusionMatrix.after_eval_iteration" title="Permalink to this definition">¶</a></dt>
<dd><p>Called after the end of an iteration by the
<cite>BaseStrategy</cite>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="avalanche.evaluation.metrics.confusion_matrix.StreamConfusionMatrix.after_eval">
<span class="sig-name descname"><span class="pre">after_eval</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">strategy</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">BaseStrategy</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">MetricResult</span></span></span><a class="reference internal" href="../../../../../_modules/avalanche/evaluation/metrics/confusion_matrix/#StreamConfusionMatrix.after_eval"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#avalanche.evaluation.metrics.confusion_matrix.StreamConfusionMatrix.after_eval" title="Permalink to this definition">¶</a></dt>
<dd><p>Called after <cite>eval</cite> by the <cite>BaseStrategy</cite>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="avalanche.evaluation.metrics.confusion_matrix.StreamConfusionMatrix.__str__">
<span class="sig-name descname"><span class="pre">__str__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../../_modules/avalanche/evaluation/metrics/confusion_matrix/#StreamConfusionMatrix.__str__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#avalanche.evaluation.metrics.confusion_matrix.StreamConfusionMatrix.__str__" title="Permalink to this definition">¶</a></dt>
<dd><p>Return str(self).</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="avalanche.evaluation.metrics.confusion_matrix.WandBStreamConfusionMatrix">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">avalanche.evaluation.metrics.confusion_matrix.</span></span><span class="sig-name descname"><span class="pre">WandBStreamConfusionMatrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">class_names</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../../_modules/avalanche/evaluation/metrics/confusion_matrix/#WandBStreamConfusionMatrix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#avalanche.evaluation.metrics.confusion_matrix.WandBStreamConfusionMatrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="../../#avalanche.evaluation.PluginMetric" title="avalanche.evaluation.PluginMetric"><code class="xref py py-class docutils literal notranslate"><span class="pre">avalanche.evaluation.PluginMetric</span></code></a></p>
<p>Confusion Matrix metric compatible with Weights and Biases logger.
Differently from the <cite>StreamConfusionMatrix</cite>, this metric will use W&amp;B
built-in functionalities to log the Confusion Matrix.</p>
<p>This metric may not produce meaningful outputs with other loggers.</p>
<p><a class="reference external" href="https://docs.wandb.ai/guides/track/log#custom-charts">https://docs.wandb.ai/guides/track/log#custom-charts</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>class_names</strong> – list of names for the classes.
E.g. [“cat”, “dog”] if class 0 == “cat” and class 1 == “dog”
If None, no class names will be used. Default None.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="avalanche.evaluation.metrics.confusion_matrix.WandBStreamConfusionMatrix.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../../../../../_modules/avalanche/evaluation/metrics/confusion_matrix/#WandBStreamConfusionMatrix.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#avalanche.evaluation.metrics.confusion_matrix.WandBStreamConfusionMatrix.reset" title="Permalink to this definition">¶</a></dt>
<dd><p>Resets the metric internal state.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="avalanche.evaluation.metrics.confusion_matrix.WandBStreamConfusionMatrix.before_eval">
<span class="sig-name descname"><span class="pre">before_eval</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">strategy</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../../../../../_modules/avalanche/evaluation/metrics/confusion_matrix/#WandBStreamConfusionMatrix.before_eval"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#avalanche.evaluation.metrics.confusion_matrix.WandBStreamConfusionMatrix.before_eval" title="Permalink to this definition">¶</a></dt>
<dd><p>Called before <cite>eval</cite> by the <cite>BaseStrategy</cite>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="avalanche.evaluation.metrics.confusion_matrix.WandBStreamConfusionMatrix.result">
<span class="sig-name descname"><span class="pre">result</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../../_modules/avalanche/evaluation/metrics/confusion_matrix/#WandBStreamConfusionMatrix.result"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#avalanche.evaluation.metrics.confusion_matrix.WandBStreamConfusionMatrix.result" title="Permalink to this definition">¶</a></dt>
<dd><p>Obtains the value of the metric.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The value of the metric.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="avalanche.evaluation.metrics.confusion_matrix.WandBStreamConfusionMatrix.update">
<span class="sig-name descname"><span class="pre">update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../../_modules/avalanche/evaluation/metrics/confusion_matrix/#WandBStreamConfusionMatrix.update"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#avalanche.evaluation.metrics.confusion_matrix.WandBStreamConfusionMatrix.update" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="avalanche.evaluation.metrics.confusion_matrix.WandBStreamConfusionMatrix.after_eval_iteration">
<span class="sig-name descname"><span class="pre">after_eval_iteration</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">strategy</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">BaseStrategy</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../../_modules/avalanche/evaluation/metrics/confusion_matrix/#WandBStreamConfusionMatrix.after_eval_iteration"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#avalanche.evaluation.metrics.confusion_matrix.WandBStreamConfusionMatrix.after_eval_iteration" title="Permalink to this definition">¶</a></dt>
<dd><p>Called after the end of an iteration by the
<cite>BaseStrategy</cite>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="avalanche.evaluation.metrics.confusion_matrix.WandBStreamConfusionMatrix.after_eval">
<span class="sig-name descname"><span class="pre">after_eval</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">strategy</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">BaseStrategy</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">MetricResult</span></span></span><a class="reference internal" href="../../../../../_modules/avalanche/evaluation/metrics/confusion_matrix/#WandBStreamConfusionMatrix.after_eval"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#avalanche.evaluation.metrics.confusion_matrix.WandBStreamConfusionMatrix.after_eval" title="Permalink to this definition">¶</a></dt>
<dd><p>Called after <cite>eval</cite> by the <cite>BaseStrategy</cite>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="avalanche.evaluation.metrics.confusion_matrix.WandBStreamConfusionMatrix.__str__">
<span class="sig-name descname"><span class="pre">__str__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../../_modules/avalanche/evaluation/metrics/confusion_matrix/#WandBStreamConfusionMatrix.__str__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#avalanche.evaluation.metrics.confusion_matrix.WandBStreamConfusionMatrix.__str__" title="Permalink to this definition">¶</a></dt>
<dd><p>Return str(self).</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="avalanche.evaluation.metrics.confusion_matrix.confusion_matrix_metrics">
<span class="sig-prename descclassname"><span class="pre">avalanche.evaluation.metrics.confusion_matrix.</span></span><span class="sig-name descname"><span class="pre">confusion_matrix_metrics</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_classes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_image</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">image_creator</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">default_cm_image_creator</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">class_names</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stream</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wandb</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">absolute_class_order</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">PluginMetric</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../../../../../_modules/avalanche/evaluation/metrics/confusion_matrix/#confusion_matrix_metrics"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#avalanche.evaluation.metrics.confusion_matrix.confusion_matrix_metrics" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper method that can be used to obtain the desired set of
plugin metrics.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>num_classes</strong> – The number of classes. Defaults to None,
which means that the number of classes will be inferred from
ground truth and prediction Tensors (see class description for more
details). If not None, the confusion matrix will always be of size
<cite>num_classes, num_classes</cite> and only the first <cite>num_classes</cite> values
of output logits or target logits will be considered in the update.
If the output or targets are provided as numerical labels,
there can be no label greater than <cite>num_classes</cite>.</p></li>
<li><p><strong>normalize</strong> – Normalizes confusion matrix over the true (rows),
predicted (columns) conditions or all the population. If None,
confusion matrix will not be normalized. Valid values are: ‘true’,
‘pred’ and ‘all’ or None.</p></li>
<li><p><strong>save_image</strong> – If True, a graphical representation of the confusion
matrix will be logged, too. If False, only the Tensor representation
will be logged. Defaults to True.</p></li>
<li><p><strong>image_creator</strong> – A callable that, given the tensor representation
of the confusion matrix, returns a graphical representation of the
matrix as a PIL Image. Defaults to <cite>default_cm_image_creator</cite>.</p></li>
<li><p><strong>class_names</strong> – W&amp;B only. List of names for the classes.
E.g. [“cat”, “dog”] if class 0 == “cat” and class 1 == “dog”
If None, no class names will be used. Default None.</p></li>
<li><p><strong>stream</strong> – If True, will return a metric able to log
the confusion matrix averaged over the entire evaluation stream
of experiences.</p></li>
<li><p><strong>wandb</strong> – if True, will return a Weights and Biases confusion matrix
together with all the other confusion matrixes requested.</p></li>
<li><p><strong>absolute_class_order</strong> – <p>Not W&amp;B. If true, the labels in the created
image will be sorted by id, otherwise they will be sorted by order of
encounter at training time. This parameter is ignored if <cite>save_image</cite> is</p>
<blockquote>
<div><p>False, or the scenario is not a NCScenario.</p>
</div></blockquote>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A list of plugin metrics.</p>
</dd>
</dl>
</dd></dl>

</div>
</div>
</div>


           </div>
           
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, ContinualAI.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>